<!-- templates/admin/dashboard.html -->
{% extends "admin/base_site.html" %} {% load admin_urls static %} 
{% block title %} Survey Dashboard {% endblock %} {% block breadcrumbs %}
<div class="breadcrumbs">
  <a href="{% url 'admin:index' %}">Home</a>
  ‚Ä∫ Dashboard
</div>
{% endblock %} {% block content %}
<div class="dashboard-stats">
  <div class="module">
    <h1>üìä Survey System Dashboard</h1>

    <!-- Quick Stats -->
    <div
      class="stats-row"
      style="display: flex; gap: 20px; margin-bottom: 30px"
    >
      <div
        class="stat-card"
        style="flex: 1; background: #f8f9fa; padding: 20px; border-radius: 8px"
      >
        <h3>Total Surveys</h3>
        <div style="font-size: 2em; color: #007cba">{{ total_surveys }}</div>
      </div>
      <div
        class="stat-card"
        style="flex: 1; background: #f8f9fa; padding: 20px; border-radius: 8px"
      >
        <h3>Active Surveys</h3>
        <div style="font-size: 2em; color: #28a745">{{ active_surveys }}</div>
      </div>
      <div
        class="stat-card"
        style="flex: 1; background: #f8f9fa; padding: 20px; border-radius: 8px"
      >
        <h3>Total Responses</h3>
        <div style="font-size: 2em; color: #17a2b8">{{ total_responses }}</div>
      </div>
    </div>

    <!-- Active Survey Performance -->
    {% if survey_stats %}
    <div class="module">
      <h2>üìà Active Survey Performance</h2>
      <div class="results">
        <table class="result-list">
          <thead>
            <tr>
              <th>Survey Title</th>
              <th>Language</th>
              <th>Responses</th>
              <th>Questions</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            {% for stat in survey_stats %}
            <tr>
              <td>
                <a
                  href="{% url 'admin:eeusurvey_app_survey_change' stat.survey.id %}"
                >
                  {{ stat.survey.title }}
                </a>
              </td>
              <td>{{ stat.survey.get_language_display }}</td>
              <td>{{ stat.response_count }}</td>
              <td>{{ stat.survey.questions.count }}</td>
              <td>
                {% if stat.response_count > 0 %}
                <a
                  href="{% url 'admin:survey_analysis' stat.survey.id %}"
                  class="button"
                  >View Analysis</a
                >
                {% endif %}
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
    {% endif %}

    <!-- Recent Activity -->
    <div class="module">
      <h2>üïí Recent Activity</h2>

      <div style="display: flex; gap: 20px">
        <!-- Recent Responses -->
        <div style="flex: 1">
          <h3>Latest Responses</h3>
          {% if recent_responses %}
          <div class="results">
            <table class="result-list">
              <thead>
                <tr>
                  <th>Survey</th>
                  <th>Submitted</th>
                </tr>
              </thead>
              <tbody>
                {% for response in recent_responses %}
                <tr>
                  <td>
                    <a
                      href="{% url 'admin:eeusurvey_app_surveyresponse_change' response.id %}"
                    >
                      {{ response.survey.title|truncatechars:40 }}
                    </a>
                  </td>
                  <td>{{ response.submitted_at|timesince }} ago</td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
          {% else %}
          <p>No recent responses</p>
          {% endif %}
        </div>

        <!-- Recent Surveys -->
        <div style="flex: 1">
          <h3>Recently Created Surveys</h3>
          {% if recent_surveys %}
          <div class="results">
            <table class="result-list">
              <thead>
                <tr>
                  <th>Title</th>
                  <th>Created</th>
                  <th>Status</th>
                </tr>
              </thead>
              <tbody>
                {% for survey in recent_surveys %}
                <tr>
                  <td>
                    <a
                      href="{% url 'admin:eeusurvey_app_survey_change' survey.id %}"
                    >
                      {{ survey.title|truncatechars:30 }}
                    </a>
                  </td>
                  <td>{{ survey.created_at|timesince }} ago</td>
                  <td>
                    {% if survey.is_active %}
                    <span style="color: green">Active</span>
                    {% else %}
                    <span style="color: red">Inactive</span>
                    {% endif %}
                  </td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
          {% else %}
          <p>No recent surveys</p>
          {% endif %}
        </div>
      </div>
    </div>

    <!-- Quick Actions -->
    <div class="module">
      <h2>‚ö° Quick Actions</h2>
      <div style="display: flex; gap: 15px; flex-wrap: wrap">
        <a
          href="{% url 'admin:eeusurvey_app_survey_add' %}"
          class="button default"
          >‚ûï Create New Survey</a
        >
        <a
          href="{% url 'admin:eeusurvey_app_survey_changelist' %}"
          class="button"
          >üìã View All Surveys</a
        >
        <a
          href="{% url 'admin:eeusurvey_app_surveyresponse_changelist' %}"
          class="button"
          >üìä View All Responses</a
        >
        <a
          href="{% url 'admin:eeusurvey_app_question_changelist' %}"
          class="button"
          >‚ùì Manage Questions</a
        >
      </div>
    </div>
  </div>
</div>

<style>
  .stats-row {
    display: flex;
    gap: 20px;
    margin-bottom: 30px;
  }

  .stat-card {
    flex: 1;
    background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    padding: 20px;
    border-radius: 8px;
    text-align: center;
    border: 1px solid #dee2e6;
  }

  .stat-card h3 {
    margin: 0 0 10px 0;
    color: #495057;
    font-size: 0.9em;
    text-transform: uppercase;
    font-weight: 600;
  }

  .stat-card div {
    font-size: 2em;
    font-weight: bold;
    margin: 0;
  }

  .module h2 {
    border-bottom: 2px solid #007cba;
    padding-bottom: 5px;
    margin-bottom: 15px;
  }

  .button {
    display: inline-block;
    padding: 8px 16px;
    margin: 2px;
    background: #007cba;
    color: white;
    text-decoration: none;
    border-radius: 4px;
    font-size: 13px;
  }

  .button:hover {
    background: #005a87;
    color: white;
  }

  .button.default {
    background: #28a745;
  }

  .button.default:hover {
    background: #218838;
  }
</style>
{% endblock %}
